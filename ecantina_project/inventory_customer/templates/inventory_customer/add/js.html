<script>
    function ajax_submit() {
        var url = '/inventory/{{ org.org_id }}/{{ store.store_id }}/add_customer/submit';
        
        var data = new FormData();
        // Store
        data.append('csrfmiddlewaretoken', '{{ csrf_token }}');
        data.append('first_name', $('#id_first_name').val());
        data.append('last_name', $('#id_last_name').val());
        data.append('joined', get_date());
        data.append('email', $('#id_email').val());
        data.append('upload_id', $('#id_hidden_upload_id').val());
        data.append('name', $('#id_name').val());
        data.append('description', $('#id_description').val());
        data.append('phone', $('#id_phone').val());
        data.append('fax', $('#id_fax').val());
        data.append('website', $('#id_website').val());
        data.append('twitter_url', $('#id_twitter_url').val());
        data.append('facebook_url', $('#id_facebook_url').val());
        data.append('instagram_url', $('#id_instagram_url').val());
        data.append('linkedin_url', $('#id_linkedin_url').val());
        data.append('github_url', $('#id_github_url').val());
        data.append('google_url', $('#id_google_url').val());
        data.append('youtube_url', $('#id_youtube_url').val());
        data.append('flickr_url', $('#id_flickr_url').val());
        data.append('street_number', $('#id_street_number').val());
        data.append('street_name', $('#id_street_name').val());
        data.append('unit_number', $('#id_unit_number').val());
        data.append('city', $('#id_city').val());
        data.append('country', $('#id_country').val());
        data.append('province', $('#id_province').val());
        data.append('postal', $('#id_postal').val());
        data.append('has_consented', $('#id_has_consented').is(':checked'));
        
        jQuery.ajax({
            url: url,
            data: data,
            cache: false,
            contentType: false,
            processData: false,
            type: 'POST',
            success: function(json_result){
                if (json_result.status == "success")
                {
                    //alert("ok saved"); // Debugging Purposes
                    window.location = '/inventory/{{ org.org_id }}/{{ store.store_id }}/customers';
                }
                else
                {
                    alert(json_result.message);
                }
            },
            error: function(xhr,status,error) {
                console.debug(status + ': ' + error + ' -- ' + xhr.responseText);
            },
            complete: function(xhr,status) {
                    
            }
        });
    }

    function get_date()
    {
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth()+1; //January is 0!
        var yyyy = today.getFullYear();
    
        if(dd<10) {
            dd='0'+dd
        }
    
        if(mm<10) {
            mm='0'+mm
        }
    
        today = yyyy+'-'+mm+'-'+dd;
        return today
    }
</script>