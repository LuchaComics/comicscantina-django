{% load staticfiles %}
<script>
    $(document).ready(function () {
       /**
        *  The following section makes the 'sections' automatically load
        *  when this page is refreshed or loaded.
        */
        ajax_refresh_table();
    });
    
    
    function ajax_refresh_table() {
        var url = '/inventory/{{ org.org_id }}/{{ store.store_id }}/customers/refresh_table';
        
        var data = new FormData();
        // Store
        data.append('csrfmiddlewaretoken', '{{ csrf_token }}');
        jQuery.ajax({
            url: url,
            data: data,
            cache: false,
            contentType: false,
            processData: false,
            type: 'POST',
            success: function(result){
                $('#ajax_placeholder').html(result); // Update UI.
            },
            error: function(xhr,status,error) {
                console.debug(status + ': ' + error + ' -- ' + xhr.responseText);
            },
            complete: function(xhr,status) {
                    
            }
        });
    }

    function ajax_delete_customer(customer_id) {
        var url = '/inventory/{{ org.org_id }}/{{ store.store_id }}/customers/delete';
    
        var data = new FormData();
        // Store
        data.append('csrfmiddlewaretoken', '{{ csrf_token }}');
        data.append('customer_id', customer_id);
        jQuery.ajax({
            url: url,
            data: data,
            cache: false,
            contentType: false,
            processData: false,
            type: 'POST',
            success: function(json_result){
                if (json_result.status == "success")
                {
                    //alert("ok saved"); // Debugging Purposes
                    //window.location = ''; // Reload page.
                    ajax_refresh_table();
                }
                else
                {
                    alert(json_result.message);
                }
            },
            error: function(xhr,status,error) {
                console.debug(status + ': ' + error + ' -- ' + xhr.responseText);
            },
            complete: function(xhr,status) {
                
            }
        });
    }
</script>