{% load staticfiles %}
<script>
    // When document loads for first time, disable the issues searching.
    $(document).ready(function() {
        $('#id_issue').prop("disabled", true);
        $('#id_issue_publisher').prop("disabled", true);
    });
    
    // Whenever user starts typing a textbox, start dynamically
    // making ajax calls to look up the results.
    $(document).ready(function() {
        var thread = null;
        function lookupSeries() {
            var series =  $('#id_series').val();
            var publisher =  $('#id_publisher').val();
            var from =  $('#id_from').val();
            var to =  $('#id_to').val();
                      
            // Print to Console
            console.log('Series: ' + series + ' | Publisher: ' + publisher + ' | From: ' + from + ' | To: ' + to);
            ajax_search(series, publisher, from, to); // Call our application and return results.
        }
           
        // SERIES
        $('#id_series').keyup(function() {
            clearTimeout(thread);
            thread = setTimeout(function() { lookupSeries(); }, 500);
        });
                      
        // PUBLISHER
        $('#id_publisher').keyup(function() {
            clearTimeout(thread);
            thread = setTimeout(function() { lookupSeries(); }, 500);
        });
                      
        // FROM
        $('#id_from').keyup(function() {
            clearTimeout(thread);
            thread = setTimeout(function() { lookupSeries(); }, 500);
        });
                      
        // TO
        $('#id_to').keyup(function() {
            clearTimeout(thread);
            thread = setTimeout(function() { lookupSeries(); }, 500);
        });
    });
    
    function ajax_search(series, publisher, from, to)
    {
        var url = '/inventory/search_series';
        
        $.ajax( url, {
            data: {
               'series' : series,
               'publisher' : publisher,
               'from' : from,
               'to' : to,
               'csrfmiddlewaretoken': '{{ csrf_token }}',
            },
            type: 'post',
            success: function(result) {
               // success code execution here
               $('#ajax_series_results_placeholder').html(result); // Update UI.
            },
            error: function(xhr,status,error) {
            
            // error code here
            },
            complete: function(xhr,status) {
               // completion code here
            }
        });
    }

    // When document load, enable 'Advanced Search' button to cause a drop
    // down animation with more search results.
    $(document).ready(function(){
        $('#search-series-list .inventory-search-list .search-list-item').click(function(){
        $('#search-series-list .inventory-search-list .search-list-item').removeClass('bg-info-dark');
        $(this).addClass('bg-info-dark');
    });
           
    // When changing the slider, store the values.
    $( "#slider-range-price" ).slider({
        range: true,
        min: 0,
        max: 150,
        values: [ 25, 100 ],
        slide: function( event, ui ) {
        $( "#price-amount" ).val( "$" + ui.values[ 0 ] + " - $" + ui.values[ 1 ] );
    }
    });
    $( "#price-amount" ).val( "$" + $( "#slider-range-price" ).slider( "values", 0 ) +
                                               " - $" + $( "#slider-range-price" ).slider( "values", 1 ) );
        $('#issues-adv-search-toggle, #series-adv-search-toggle').on('click', function(){
            $(this).next().next().slideToggle();
        });
    });
    
    // Whenever user starts typing a textbox, start dynamically
    // making ajax calls to look up the results.
    $(document).ready(function() {
        var thread = null;
        function lookupIssues() {
            var series =  $('#id_series').val();
            var issue =  $('#id_issue').val();
            var publisher =  $('#id_issue_publisher').val();
                      
            // Print to Console
            console.log('Series: ' + series + ' | Publisher: ' + publisher);
            ajax_search_issues(series, issue, publisher); // Call our application and return results.
        }
                      
        // ISSUE
        $('#id_issue').keyup(function() {
            clearTimeout(thread);
            thread = setTimeout(function() { lookupIssues(); }, 500);
        });
                      
        // ISSUE PUBLISHER
        $('#id_issue_publisher').keyup(function() {
            clearTimeout(thread);
            thread = setTimeout(function() { lookupIssues(); }, 500);
        });
    });
                    
    function ajax_search_issues(series, issue, publisher)
    {
        var url = '/inventory/search_issues';
        
        $.ajax( url, {
            data: {
                'series' : series,
                'issue' : issue,
                'publisher' : publisher,
                'csrfmiddlewaretoken': '{{ csrf_token }}',
            },
            type: 'post',
                success: function(result) {
                // success code execution here
                $('#ajax_issues_results_placeholder').html(result); // Update UI.
            },
            error: function(xhr,status,error) {
                // error code here
            },
            complete: function(xhr,status) {
                // completion code here
            }
        });
    }
</script>